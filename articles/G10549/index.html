<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-5"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-8');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üí™üèª üè∏ üë®üèº‚Äçüåæ Merge Sort: Algorithm, Benefits and Features ü•° üòö üëßüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Merge sorting is one of the basic informatics algorithms formulated back in 1945 by the great mathematician John von Neumann. Participating in the Man...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://books-in-short.github.io/index.html"></a>
    <div class="page-header-text">Books in Short</div>
  </header>
  <section class="page js-page"><h1>Merge Sort: Algorithm, Benefits and Features</h1><article itemscope="" itemtype="http://schema.org/Article" class="article .page"><div id="content" class="pagedata"><p>  Merge sorting is one of the basic informatics algorithms formulated back in 1945 by the great mathematician John <span>von Neumann.</span>  Participating in the Manhattan Project, Neumann was faced with the need to efficiently process huge amounts of data.  The method developed by him used the principle of "divide and conquer", which allowed to significantly reduce the time required for work. </p><h2>  Principle and use of the algorithm </h2><p>  The merge sorting method is used in sorting problems of structures that have ordered access to elements, for example, arrays, lists, streams. </p><p>  During processing, the initial data block is split into small components, up to one element, which in essence is already a sorted list.  Then reassembly takes place in the correct order. </p><div class="photo" data-original="interactivepython.org" data-author=": "><img itemprop="image" alt="Merge Sort" class="if uuid-2509987" src="https://fb.ru/misc/i/gallery/39768/2509987.jpg"></div><p>  Sorting an array of a certain length requires an additional memory area of ‚Äã‚Äãa similar size, in which a sorted array is assembled in parts. </p><p>  The method can be used to organize any comparable data types, such as numbers or strings. </p><h2>  Merging Sorted Plots </h2><p>  To understand the algorithm, we will start its analysis from the end - from the mechanism of merging sorted blocks. </p><div id="NRent-5ced10a04aa78-2"></div><p>  Imagine that we have two sorted arrays of numbers in any way that need to be combined with each other so that the sorting is not violated.  For simplicity, we will arrange the numbers in ascending order. </p><p>  Elementary example: both arrays consist of one element each. </p><pre class=" language-java"><code class=" language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr1 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">31</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr2 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code> </pre> <p>  To merge them, you need to take the zero element of the first array (do not forget that the numbering starts from zero) and the zero element of the second array.  These are, respectively, 31 and 18. By the sorting condition, the number 18 should go first, since it is less.  Just arrange the numbers in the correct order: </p><pre class=" language-java"> <code class=" language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> result <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code> </pre> <p>  Let's turn to a more complicated example, in which each array consists of several elements: </p><pre class=" language-java"> <code class=" language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr1 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr2 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code> </pre> <p>  The merge algorithm will consist in comparing the smaller elements sequentially and placing them in the resulting array in the correct order.  To track the current indexes, we introduce two variables - index1 and index2.  Initially, we equate them to zero, since the arrays are sorted, and the smallest elements are at the beginning. </p><pre class=" language-java"> <code class=" language-java"><span class="token keyword">int</span> index1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">int</span> index2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></code> </pre> <p>  We will describe in steps the whole merger process: </p><ol><li>  We take from the arr1 array the element with index1, and from the arr2 array - with index2. </li><li>  Compare, select the smallest of them and put in the resulting array. </li><li>  Increase the current index of the smaller element by 1. </li><li>  We continue from the first step. </li></ol><div class="photo" data-original="sites.google.com" data-author=": "><img itemprop="image" alt="Merging Ordered Arrays" class="if uuid-2509984" src="https://fb.ru/misc/i/gallery/39768/2509984.jpg"></div><p>  At the first turn, the situation will look like this: </p><div id="inpage"></div><div id="NRent-5ced10a04aa78-3"></div><pre class=" language-java"> <code class=" language-java">index1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> arr1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span> arr2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> arr1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> arr2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> index1<span class="token operator">++</span><span class="token punctuation">;</span> result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> arr1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// result = [2]</span></code> </pre> <p>  In the second round: </p><pre class=" language-java"> <code class=" language-java">index1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> index2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> arr1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">17</span><span class="token punctuation">;</span> arr2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> arr1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> arr2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> index2<span class="token operator">++</span><span class="token punctuation">;</span> result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> arr2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// result = [2, 5]</span></code> </pre> <p>  On the third: </p><pre class=" language-java"> <code class=" language-java">index1 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> index2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> arr1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">17</span><span class="token punctuation">;</span> arr2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span> arr1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> arr2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> index2<span class="token operator">++</span><span class="token punctuation">;</span> result<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> arr2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// result = [2, 5, 6]</span></code> </pre> <p>  And so on, until you end up with a fully sorted resulting array: {2, 5, 6, 17, 21, 19, 30, 45}. </p><p>  Certain difficulties can arise if arrays with different lengths merge.  What if one of the current indices reaches the last element, and there are still members in the second array? </p><pre class=" language-java"> <code class=" language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr1 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr2 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 1 step index1 = 0, index2 = 0; 1 &lt; 2 result = {1}; // 2 step index1 = 1, index2 = 0; 4 &gt; 2 result = {1, 2}; // 3 step index1 = 1, index2 = 1; 4 &lt; 5 result = {1, 2, 4}; //4 step index1 = 2, index2 = 1 ??</span></code> </pre> <p>  The variable index1 has reached the value 2, however the array arr1 does not have an element with such an index.  Everything is simple here: it is enough to transfer the remaining elements of the second array to the resulting one, preserving their order. </p><pre class=" language-java"> <code class=" language-java">result <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">;</span></code> </pre> <p>  This situation indicates to us the need to compare the current check index with the length of the merged array. </p><p>  Scheme for merging ordered sequences (A and B) of different lengths: </p><ul><li>  If the length of both sequences is greater than 0, compare A [0] and B [0] and move the smaller one to the buffer. </li><li>  If the length of one of the sequences is 0, take the remaining elements of the second sequence and, without changing their order, transfer to the end of the buffer. </li></ul><h2>  Second stage implementation </h2><p>  An example of combining two sorted arrays in the Java language is given below. </p><pre class=" language-java"> <code class=" language-java"><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">900</span><span class="token punctuation">,</span> <span class="token number">2100</span><span class="token punctuation">,</span> <span class="token number">2200</span><span class="token punctuation">,</span> <span class="token number">2300</span><span class="token punctuation">,</span> <span class="token number">2400</span><span class="token punctuation">,</span> <span class="token number">2500</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">65</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">190</span><span class="token punctuation">,</span> <span class="token number">1100</span><span class="token punctuation">,</span> <span class="token number">1200</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">int</span><span class="token punctuation">[</span>a1<span class="token punctuation">.</span>length <span class="token operator">+</span> a2<span class="token punctuation">.</span>length<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> k<span class="token operator">&lt;</span>a3<span class="token punctuation">.</span>length<span class="token punctuation">;</span> k<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;</span> a1<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">int</span> a <span class="token operator">=</span> a2<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span> a3<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">&gt;</span> a2<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">int</span> a <span class="token operator">=</span> a1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> a3<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>a1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">&lt;</span> a2<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">int</span> a <span class="token operator">=</span> a1<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> a3<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> a<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token keyword">int</span> b <span class="token operator">=</span> a2<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span> a3<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> b<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span></code> </pre> <p>  Here: </p><ul><li>  a1 and a2 are the original sorted arrays that need to be combined; </li><li>  a3 is the final array; </li><li>  i and j are the indices of the current elements for arrays a1 and a2. </li></ul><p>  The first and second if conditions ensure that indexes do not go beyond the size of the array.  The third and fourth blocks of conditions, respectively, are moved to the resulting array of the smaller element. </p><div class="photo" data-original="xmfpes.github.io" data-author=": "><img itemprop="image" alt="Merge Sort Rows" class="if uuid-2509861" src="https://fb.ru/misc/i/gallery/39768/2509861.jpg"></div><h2>  Divide and rule </h2><p>  So we learned how to combine sorted collections of values.  We can say that the second part of the merge sorting algorithm - directly merging - is already parsed. </p><p>  However, it is also necessary to understand how to get from a source unsorted array of numbers to several sorted ones that can be merged. </p><p>  Consider the first stage of the algorithm and learn how to separate arrays. </p><p>  There is nothing complicated about it - the initial list of values ‚Äã‚Äãis divided in half, then each part is also bifurcated, and so on until very small blocks are obtained. </p><p>  The length of such minimal elements can be equal to one, that is, they can themselves be a sorted array, however this is not a prerequisite.  The size of the block is determined in advance, and any suitable sorting algorithm that works effectively with small-sized arrays (for example, quick sort or insertion sorting) can be used to organize it. </p><p>  It looks as follows. </p><pre class=" language-java"> <code class=" language-java"><span class="token comment">//   {34, 95, 10, 2, 102, 70}; //   {34, 95, 10}  {2, 102, 70}; //   {34}  {95, 10}  {2}  {102, 70}</span></code> </pre> <p>  The resulting blocks, consisting of 1-2 elements, are very simple to arrange. </p><p>  After that, it is necessary to combine the already sorted small arrays in pairs, preserving the order of the members, which we have already learned to do. </p><div class="photo" data-original="www.instanceofjava.com" data-author=": "><img itemprop="image" alt="Merge array sorting scheme" class="if uuid-2509855" src="https://fb.ru/misc/i/gallery/39768/2509855.jpg"></div><h2>  Phase One Implementation </h2><p>  Recursive partitioning of an array is shown below. </p><pre class=" language-c"> <code class=" language-c"><span class="token keyword">void</span> <span class="token function">mergeSort</span><span class="token punctuation">(</span>T a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">long</span> start<span class="token punctuation">,</span> <span class="token keyword">long</span> finish<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">long</span> split<span class="token punctuation">;</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>start <span class="token operator">&lt;</span> finish<span class="token punctuation">)</span> <span class="token punctuation">{</span> split <span class="token operator">=</span> <span class="token punctuation">(</span>start <span class="token operator">+</span> finish<span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span> <span class="token function">mergeSort</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> start<span class="token punctuation">,</span> split<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">mergeSort</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> split<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> finish<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">merge</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> start<span class="token punctuation">,</span> split<span class="token punctuation">,</span> finish<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span></code> </pre> <p>  What happens in this code: </p><ol><li>  The mergeSort function gets the original array <code>a</code> and the left and right borders of the section to be sorted (start and <code>finish</code> indices). </li><li>  If the length of this section is greater than one ( <code>start &lt; finish</code> ), then it is divided into two parts (by the <code>split</code> index), and each of them is recursively sorted. </li><li>  In the recursive function call for the left side, the initial parcel index and the <code>split</code> index are passed.  For the right one, respectively, the beginning will be <code>(split + 1)</code> , and the end will be the last index of the source section. </li><li>  The <code>merge</code> function receives two ordered sequences ( <code>a[start]...a[split]</code> and <code>a[split+1]...a[finish]</code> ) and merges them while preserving the sort order. </li></ol><p>  The mechanics of the merge function are discussed above. </p><h2>  General algorithm scheme </h2><p>  The merge array sorting method consists of two large steps: </p><ul><li>  Divide the unsorted source array into small parts. </li><li>  Collect them in pairs, following the sorting rule. </li></ul><p>  The big and difficult task here is divided into many simple ones, which are successively solved, leading to the desired result. </p><div class="photo" data-original="idea-instructions.com" data-author=": "><img itemprop="image" alt="Merge Sort Algorithm" class="if uuid-2509879" src="https://fb.ru/misc/i/gallery/39768/2509879.jpg"></div><h2>  Evaluation of the method </h2><p>  The time complexity of merge sorting is determined by the height of the algorithm partition tree and is equal to the number of elements in the array (n) multiplied by its logarithm (log n).  Such an estimate is called logarithmic. </p><p>  This is both a virtue and a disadvantage of the method.  Its operating time does not change even in the worst case, when the original array is sorted in reverse order.  However, when processing completely sorted data, the algorithm does not provide a time gain. </p><p>  It is important to note the memory overhead when using the merge sort method.  They are equal to the size of the original collection.  In this additionally selected area, a sorted array is assembled from pieces. </p><h2>  Algorithm implementation </h2><p>  Pascal merge sort is shown below. </p><pre class=" language-php"> <code class=" language-php">Procedure <span class="token function">MergeSort</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> string<span class="token punctuation">;</span> <span class="token keyword">var</span> f<span class="token punctuation">:</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">Var</span> a1<span class="token punctuation">,</span>a2<span class="token punctuation">,</span>s<span class="token punctuation">,</span>i<span class="token punctuation">,</span>j<span class="token punctuation">,</span>kol<span class="token punctuation">,</span>tmp<span class="token punctuation">:</span> integer<span class="token punctuation">;</span> f1<span class="token punctuation">,</span>f2<span class="token punctuation">:</span> text<span class="token punctuation">;</span> b<span class="token punctuation">:</span> boolean<span class="token punctuation">;</span> Begin kol<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token function">Assign</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Reset</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">While</span> not <span class="token function">EOF</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token keyword">do</span> begin <span class="token function">read</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span>a1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">inc</span><span class="token punctuation">(</span>kol<span class="token punctuation">)</span><span class="token punctuation">;</span> End<span class="token punctuation">;</span> <span class="token function">Close</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Assign</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span><span class="token string">'{ 1-  }'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Assign</span><span class="token punctuation">(</span>f2<span class="token punctuation">,</span><span class="token string">'{ 2-  }'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> s<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token keyword">While</span> <span class="token punctuation">(</span>s<span class="token operator">&lt;</span>kol<span class="token punctuation">)</span> <span class="token keyword">do</span> begin <span class="token function">Reset</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Rewrite</span><span class="token punctuation">(</span>f1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Rewrite</span><span class="token punctuation">(</span>f2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">For</span> i<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">1</span> to kol div <span class="token number">2</span> <span class="token keyword">do</span> begin <span class="token function">Read</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span>a1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Write</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span>a1<span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span> End<span class="token punctuation">;</span> <span class="token keyword">If</span> <span class="token punctuation">(</span>kol div <span class="token number">2</span><span class="token punctuation">)</span> mod s<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token number">0</span> then begin tmp<span class="token punctuation">:</span><span class="token operator">=</span>kol div <span class="token number">2</span><span class="token punctuation">;</span> <span class="token keyword">While</span> tmp mod s<span class="token operator">&lt;</span><span class="token operator">&gt;</span><span class="token number">0</span> <span class="token keyword">do</span> begin <span class="token function">Read</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span>a1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Write</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span>a1<span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">inc</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span> End<span class="token punctuation">;</span> End<span class="token punctuation">;</span> <span class="token keyword">While</span> not <span class="token function">EOF</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token keyword">do</span> begin <span class="token function">Read</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span>a2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Write</span><span class="token punctuation">(</span>f2<span class="token punctuation">,</span>a2<span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span> End<span class="token punctuation">;</span> <span class="token function">Close</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Close</span><span class="token punctuation">(</span>f1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Close</span><span class="token punctuation">(</span>f2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Rewrite</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Reset</span><span class="token punctuation">(</span>f1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Reset</span><span class="token punctuation">(</span>f2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Read</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span>a1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Read</span><span class="token punctuation">(</span>f2<span class="token punctuation">,</span>a2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">While</span> <span class="token punctuation">(</span>not <span class="token function">EOF</span><span class="token punctuation">(</span>f1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>not <span class="token function">EOF</span><span class="token punctuation">(</span>f2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">do</span> begin i<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> j<span class="token punctuation">:</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> b<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token keyword">While</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>not <span class="token function">EOF</span><span class="token punctuation">(</span>f1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>not <span class="token function">EOF</span><span class="token punctuation">(</span>f2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">do</span> begin <span class="token keyword">If</span> <span class="token punctuation">(</span>a1<span class="token operator">&lt;</span>a2<span class="token punctuation">)</span> then begin <span class="token function">Write</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span>a1<span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Read</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span>a1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">inc</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> End <span class="token keyword">else</span> begin <span class="token function">Write</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span>a2<span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Read</span><span class="token punctuation">(</span>f2<span class="token punctuation">,</span>a2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">inc</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span> End<span class="token punctuation">;</span> <span class="token keyword">If</span> <span class="token punctuation">(</span>i<span class="token operator">=</span>s<span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token punctuation">(</span>j<span class="token operator">=</span>s<span class="token punctuation">)</span> then b<span class="token punctuation">:</span><span class="token operator">=</span><span class="token boolean">false</span><span class="token punctuation">;</span> End<span class="token punctuation">;</span> <span class="token keyword">If</span> not b then begin <span class="token keyword">While</span> <span class="token punctuation">(</span>i<span class="token operator">&lt;</span>s<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>not <span class="token function">EOF</span><span class="token punctuation">(</span>f1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">do</span> begin <span class="token function">Write</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span>a1<span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Read</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span>a1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">inc</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span> End<span class="token punctuation">;</span> <span class="token keyword">While</span> <span class="token punctuation">(</span>j<span class="token operator">&lt;</span>s<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>not <span class="token function">EOF</span><span class="token punctuation">(</span>f2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">do</span> begin <span class="token function">Write</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span>a2<span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Read</span><span class="token punctuation">(</span>f2<span class="token punctuation">,</span>a2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">inc</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span> End<span class="token punctuation">;</span> End<span class="token punctuation">;</span> End<span class="token punctuation">;</span> <span class="token keyword">While</span> not <span class="token function">EOF</span><span class="token punctuation">(</span>f1<span class="token punctuation">)</span> <span class="token keyword">do</span> begin tmp<span class="token punctuation">:</span><span class="token operator">=</span>a1<span class="token punctuation">;</span> <span class="token function">Read</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span>a1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">If</span> not <span class="token function">EOF</span><span class="token punctuation">(</span>f1<span class="token punctuation">)</span> then <span class="token function">Write</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span>tmp<span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token function">Write</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span> End<span class="token punctuation">;</span> <span class="token keyword">While</span> not <span class="token function">EOF</span><span class="token punctuation">(</span>f2<span class="token punctuation">)</span> <span class="token keyword">do</span> begin tmp<span class="token punctuation">:</span><span class="token operator">=</span>a2<span class="token punctuation">;</span> <span class="token function">Read</span><span class="token punctuation">(</span>f2<span class="token punctuation">,</span>a2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">If</span> not <span class="token function">EOF</span><span class="token punctuation">(</span>f2<span class="token punctuation">)</span> then <span class="token function">Write</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span>tmp<span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token function">Write</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span> End<span class="token punctuation">;</span> <span class="token function">Close</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Close</span><span class="token punctuation">(</span>f1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Close</span><span class="token punctuation">(</span>f2<span class="token punctuation">)</span><span class="token punctuation">;</span> s<span class="token punctuation">:</span><span class="token operator">=</span>s<span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">;</span> End<span class="token punctuation">;</span> <span class="token function">Erase</span><span class="token punctuation">(</span>f1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token function">Erase</span><span class="token punctuation">(</span>f2<span class="token punctuation">)</span><span class="token punctuation">;</span> End<span class="token punctuation">;</span></code> </pre> <p>  Visually, the operation of the algorithm looks like this (above is an unordered sequence, below is an ordered sequence). </p><div class="photo" data-original="medium.com" data-author=": "><img itemprop="image" alt="Insert Sort Visualization" class="if uuid-2509931" src="https://fb.ru/misc/i/gallery/39768/2509931.jpg"></div><h2>  External data sorting </h2><p>  Very often there is a need to sort some data located in the external memory of the computer.  In some cases, they are impressive in size and cannot be placed in RAM to facilitate access to them.  For such cases, external sorting methods are used. </p><p>  The need to access external media degrades the temporary processing efficiency. </p><p>  The complexity of the work lies in the fact that the algorithm at each moment in time can have access to only one element of the data stream.  And in this case, one of the best results is shown by the merge sort method, which can compare the elements of two files sequentially one after another. </p><p>  Reading data from an external source, its processing and writing to the final file are carried out in ordered blocks (series).  According to the method of working with the size of ordered series, two types of sorting are distinguished: simple and natural merging. </p><div class="photo" data-original="i.ytimg.com" data-author=": "><img itemprop="image" alt="External merge sort" class="if uuid-2509865" src="https://fb.ru/misc/i/gallery/39768/2509865.jpg"></div><h2>  Simple merge </h2><p>  With a simple merge, the length of the series is fixed. </p><p>  So, in the original unsorted file, all series consist of one element.  After the first step, the size increases to two.  Next - 4, 8, 16 and so on. </p><p>  It works as follows: </p><ol><li>  The source file (f) is divided into two auxiliary files - f1, f2. </li><li>  They merge again into one file (f), but at the same time all the elements are compared in pairs and form pairs already.  The series size at this step becomes equal to two. </li><li>  Repeat step 1. </li><li>  Step 2 is repeated, but the already ordered deuces merge, forming sorted fours. </li><li>  The cycle continues, accompanied by an increase in the series at each turn, until the entire file is sorted. </li></ol><p>  How to understand that external sorting by simple merge is complete? </p><ul><li>  the new length of the series (after merging) is not less than the total number of elements; </li><li>  there is only one episode left; </li><li>  helper file f2 remained empty. </li></ul><p>  The disadvantages of a simple merge are the following: since the length of the series is fixed at each merge pass, partially ordered data will be processed as long as it is absolutely chaotic. </p><h2>  Natural fusion </h2><p>  This method does not limit the length of the series, but selects the maximum possible. </p><p>  Sort Algorithm: </p><ol><li>  Reading the source sequence from file f begins.  The first item received is written to file f1. </li><li>  If the next record satisfies the sorting condition, it is written there, if not, then to the second auxiliary file f2. </li><li>  Thus, all the records of the source file are distributed, and in f1 an ordered sequence is formed, which determines the current size of the series. </li><li>  Files f1 and f2 merge. </li><li>  The cycle repeats. </li></ol><p>  Due to the fixed size of the series, it is necessary to designate the end of the sequence with a special symbol.  Therefore, when merging, the number of comparisons increases.  In addition, the size of one of the auxiliary files may approach the size of the original. </p><p>  On average, the natural merge method works more efficiently than a simple merge in external sorting. </p><h2>  Algorithm Features </h2><p>  When comparing two identical values, the method preserves their original order, that is, it is stable. </p><p>  The sorting process can be very successfully divided into several threads. </p><div class="photo photo--thumb js-video-thumb" data-id="XaqR3G_NVoo" data-url="https://www.youtube.com/watch?v=XaqR3G_NVoo&amp;feature=youtu.be" data-width="560" data-height="315"><img itemprop="image" src="https://fb.ru/misc/i/y/3/0/6/0/3060.jpg"></div><p>  The video clearly demonstrates the operation of the merge array sorting algorithm. </p>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <p></p>
    </div></article>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../G10544/index.html">Alterations, sewing from old things with their own hands for children</a></li>
<li><a href="../G10545/index.html">Rios Beach Hotel Certified Municipal (Turkey / Kemer): photos and reviews of tourists from Russia</a></li>
<li><a href="../G10546/index.html">DIY tube transceiver</a></li>
<li><a href="../G10547/index.html">Philip Orlik and his Constitution</a></li>
<li><a href="../G10548/index.html">Traveller's checks - what is it? How to pay with traveler's checks and where to buy?</a></li>
<li><a href="../G1055/index.html">Political marketing</a></li>
<li><a href="../G10550/index.html">Deer of cones: how to make</a></li>
<li><a href="../G10551/index.html">Hotel Garcia Resort Spa 5 *. Turkey, Fethiye - hotels</a></li>
<li><a href="../G10552/index.html">Leganya Beach Hotel 3 *: hotel description, reviews</a></li>
<li><a href="../G10553/index.html">The best hotels of Balashikha: addresses, description, services</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57465334 = new Ya.Metrika({
                  id:57465334,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57465334" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-8', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Books in Short | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2020</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=VE9H7v77vvWNEMhQH-j5Be_qjj0YcBcXSh3tK9RhEb4&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>